<p-card [style]="{ margin: '100px 20px' }">
  <div class="flex flex-row justify-content-between align-items-center gap-3">
    <div class="flex flex-row align-items-center gap-3">
      <h1>Students overview</h1>
      <p-badge [value]="studentsCount()" badgeSize="xlarge" />
    </div>
    <div>
      <p-button
        label="Add Student"
        icon="pi pi-plus"
        (onClick)="goToMakeNew()"
      />
      <p-button
        [label]="deleteSelectedLabel()"
        icon="pi pi-trash"
        severity="danger"
        (click)="confirmBulkDelete($event)"
        [disabled]="!selectedStudents().length"
        class="m-4"
      />
    </div>
  </div>
  <!-- <div class="mb-4">
    <p-button
      type="button"
      icon="pi pi-chevron-left"
      (click)="prev()"
      [disabled]="isFirstPage()"
      text
    />
    <p-button type="button" icon="pi pi-refresh" (click)="reset()" text />
    <p-button
      type="button"
      icon="pi pi-chevron-right"
      (click)="next()"
      [disabled]="isLastPage()"
      text
    />
  </div> -->
  <p-table
    [value]="students()"
    [paginator]="true"
    [rows]="rows"
    [selection]="selectedStudents()"
    (selectionChange)="selectedStudents.set($event)"
    dataKey="id"
    emptyMessage="No students available."
    size="large"
    stripedRows
  >
    <ng-template pTemplate="header" #header>
      <tr>
        <th style="width: 4rem"><p-tableHeaderCheckbox /></th>
        <th>Name</th>
        <th>Email</th>
        <th>Courses</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-student>
      <tr (click)="goToView(student)" style="cursor: pointer">
        <td td (click)="$event.stopPropagation()">
          <p-tableCheckbox [value]="student" />
        </td>
        <td>{{ student.name }}</td>
        <td>{{ student.email }}</td>
        <!-- <td>{{ student.courses.join(', ') }}</td> -->
        <td>
          <div class="flex flex-wrap gap-1">
            <ng-container
              *ngFor="let course of student.courses.slice(0, MAX_VISIBLE_COURSES)"
            >
              <p-chip [label]="course" />
            </ng-container>

            <ng-container *ngIf="student.courses.length > MAX_VISIBLE_COURSES">
              <p-chip
                [label]="'+' + (student.courses.length - MAX_VISIBLE_COURSES) + ' more'"
                [pTooltip]="getOverflowCourses(student)"
                tooltipPosition="top"
              />
            </ng-container>
          </div>
        </td>

        <td class="flex flex-row gap-3" (click)="$event.stopPropagation()">
          <p-button
            icon="pi pi-pencil"
            aria-label="Edit student"
            [outlined]="true"
          />
          <p-button
            icon="pi pi-trash"
            severity="danger"
            [outlined]="true"
            (onClick)="confirmDelete($event, student.id)"
            aria-label="Confirm delete student"
          />
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>

<p-confirmdialog />
<p-toast />
